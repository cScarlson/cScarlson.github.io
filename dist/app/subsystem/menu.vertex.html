
<script type="module" defer>
    import { V } from './vertices/core.js';
    
    const { log } = console;
    
    V(function MenuComponent({ self, module, metadata }, type='menu') {
        const { nextElementSibling: menu } = self;
        const toggle = menu.querySelector('.menu.control.toggle');
        
        function handleToggle (e) {
            const { target } = e;
            const { checked } = target;
            const detail = { opened: checked };
            const event = new CustomEvent('menu:state', { detail });
            
            console.log(`@TOGGLE`, checked);
            menu.dispatchEvent(event);
        }
        
        function handleHashchange (e) {
            const detail = { opened: false };
            const event = new CustomEvent('menu:state', { detail });
            
            toggle.checked = detail.opened;
            menu.dispatchEvent(event);
        }
        
        // OPERATIONS
        toggle.addEventListener('change', handleToggle, false);
        window.addEventListener('hashchange', handleHashchange, false);
        
        return this;
    });
</script>

<div class="app menu">
    <input class="menu control toggle" type="checkbox" />
    <span class="menu icon">&#8801;</span>
    <slot class="menu canvas" name="menu">
        <div>
            <a href="#/noop/">Home</a>
        </div>
        <div>
            <a href="#/noop/app/about">About</a>
        </div>
        <div>
            <a href="#/noop/app/resume">Resume</a>
        </div>
        <div>
            <a href="#/noop/app/cv">Curriculum Vitae</a>
        </div>
        <div>
            <a href="#/noop/app/footer">More</a>
        </div>
    </slot>
</div>

<style>
    :root {
        --menu-height: 48px;
    }
    .app.menu {
        /* border: solid 1px tomato; */
        width: 100%;
        height: var(--menu-height);
        background-color: rgba(0, 0, 0, 0.75);
        box-shadow: 0px 0px 8px 2px black;
    }
    .app.menu .menu.control.toggle {
        outline: solid 1px tomato;
        position: absolute;
        left: 50%;
        transform: translateX(-50%);
        width: var(--menu-height);
        height: var(--menu-height);
        margin: 0;
        padding: 0;
        opacity: 0;
        z-index: 1;
        cursor: pointer;
    }
    .app.menu .menu.icon {
        display: flex;
        justify-content: center;
        align-items: center;
        position: absolute;
        left: 50%;
        transform: translateX(-50%);
        width: var(--menu-height);
        height: var(--menu-height);
        margin: 0;
        padding: 0;
        font-size: var(--menu-height);
        line-height: var(--menu-height);
        cursor: pointer;
        color: white;
    }
    .app.menu .menu.canvas {
        position: absolute;
        top: var(--menu-height);
        display: block;
        width: 100%;
        height: calc(100vh - var(--menu-height));
        transform: scale(0);
        transform-origin: center;
        transition: transform 500ms;
        background-color: rgba(0, 0, 0, 0.75);
        background-clip: padding-box;
        border-top: double 10px rgba(255, 255, 255, 0.5);
    }
    .app.menu .menu.control.toggle:checked ~ .menu.icon {
        color: #f09819;
    }
    .app.menu .menu.control.toggle:checked ~ .menu.canvas {
        transform: scale(1);
        transition: transform 500ms;
    }
    .app.menu .menu.canvas a {
        color: white;
        text-decoration: none;
    }
</style>
